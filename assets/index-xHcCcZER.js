(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const t of l)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function r(l){const t={};return l.integrity&&(t.integrity=l.integrity),l.referrerPolicy&&(t.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?t.credentials="include":l.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(l){if(l.ep)return;l.ep=!0;const t=r(l);fetch(l.href,t)}})();const J=0,Q=1,g=0,_=8,v=20,V=28,Z=31,ce=37,T=44,_e=52,L=54,ee=55,b=58,Y=63,te=76,H=64;class O{static read_bytes(e,r){const o=new O;return o.buf=e.getUint32(r,!0),o.buf_len=e.getUint32(r+4,!0),o}static read_bytes_array(e,r,o){const l=[];for(let t=0;t<o;t++)l.push(O.read_bytes(e,r+8*t));return l}}class C{static read_bytes(e,r){const o=new C;return o.buf=e.getUint32(r,!0),o.buf_len=e.getUint32(r+4,!0),o}static read_bytes_array(e,r,o){const l=[];for(let t=0;t<o;t++)l.push(C.read_bytes(e,r+8*t));return l}}const he=0,pe=1,fe=2,ne=2,E=3,P=4;class W{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(e,r){e.setBigUint64(r,this.d_next,!0),e.setBigUint64(r+8,this.d_ino,!0),e.setUint32(r+16,this.dir_name.length,!0),e.setUint8(r+20,this.d_type)}write_name_bytes(e,r,o){e.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,o)),r)}constructor(e,r,o,l){const t=new TextEncoder().encode(o);this.d_next=e,this.d_ino=r,this.d_namlen=t.byteLength,this.d_type=l,this.dir_name=t}}const ye=1;class K{write_bytes(e,r){e.setUint8(r,this.fs_filetype),e.setUint16(r+2,this.fs_flags,!0),e.setBigUint64(r+8,this.fs_rights_base,!0),e.setBigUint64(r+16,this.fs_rights_inherited,!0)}constructor(e,r){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=e,this.fs_flags=r}}const G=1,N=2,re=4,se=8;class ${write_bytes(e,r){e.setBigUint64(r,this.dev,!0),e.setBigUint64(r+8,this.ino,!0),e.setUint8(r+16,this.filetype),e.setBigUint64(r+24,this.nlink,!0),e.setBigUint64(r+32,this.size,!0),e.setBigUint64(r+38,this.atim,!0),e.setBigUint64(r+46,this.mtim,!0),e.setBigUint64(r+52,this.ctim,!0)}constructor(e,r,o){this.dev=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.ino=e,this.filetype=r,this.size=o}}const me=0;class ge{write_bytes(e,r){e.setUint32(r,this.pr_name.byteLength,!0)}constructor(e){this.pr_name=new TextEncoder().encode(e)}}class X{static dir(e){const r=new X;return r.tag=me,r.inner=new ge(e),r}write_bytes(e,r){e.setUint32(r,this.tag,!0),this.inner.write_bytes(e,r+4)}}let be=class{enable(e){this.log=we(e===void 0?!0:e,this.prefix)}get enabled(){return this.isEnabled}constructor(e){this.isEnabled=e,this.prefix="wasi:",this.enable(e)}};function we(w,e){return w?console.log.bind(console,"%c%s","color: #265BA0",e):()=>{}}const U=new be(!1);class ie extends Error{constructor(e){super("exit with exit code "+e),this.code=e}}let xe=class{start(e){this.inst=e;try{return e.exports._start(),0}catch(r){if(r instanceof ie)return r.code;throw r}}initialize(e){this.inst=e,e.exports._initialize&&e.exports._initialize()}constructor(e,r,o,l={}){this.args=[],this.env=[],this.fds=[],U.enable(l.debug),this.args=e,this.env=r,this.fds=o;const t=this;this.wasiImport={args_sizes_get(n,s){const i=new DataView(t.inst.exports.memory.buffer);i.setUint32(n,t.args.length,!0);let f=0;for(const a of t.args)f+=a.length+1;return i.setUint32(s,f,!0),U.log(i.getUint32(n,!0),i.getUint32(s,!0)),0},args_get(n,s){const i=new DataView(t.inst.exports.memory.buffer),f=new Uint8Array(t.inst.exports.memory.buffer),a=s;for(let u=0;u<t.args.length;u++){i.setUint32(n,s,!0),n+=4;const h=new TextEncoder().encode(t.args[u]);f.set(h,s),i.setUint8(s+h.length,0),s+=h.length+1}return U.enabled&&U.log(new TextDecoder("utf-8").decode(f.slice(a,s))),0},environ_sizes_get(n,s){const i=new DataView(t.inst.exports.memory.buffer);i.setUint32(n,t.env.length,!0);let f=0;for(const a of t.env)f+=a.length+1;return i.setUint32(s,f,!0),U.log(i.getUint32(n,!0),i.getUint32(s,!0)),0},environ_get(n,s){const i=new DataView(t.inst.exports.memory.buffer),f=new Uint8Array(t.inst.exports.memory.buffer),a=s;for(let u=0;u<t.env.length;u++){i.setUint32(n,s,!0),n+=4;const h=new TextEncoder().encode(t.env[u]);f.set(h,s),i.setUint8(s+h.length,0),s+=h.length+1}return U.enabled&&U.log(new TextDecoder("utf-8").decode(f.slice(a,s))),0},clock_res_get(n,s){let i;switch(n){case Q:{i=5000n;break}case J:{i=1000000n;break}default:return _e}return new DataView(t.inst.exports.memory.buffer).setBigUint64(s,i,!0),g},clock_time_get(n,s,i){const f=new DataView(t.inst.exports.memory.buffer);if(n===J)f.setBigUint64(i,BigInt(new Date().getTime())*1000000n,!0);else if(n==Q){let a;try{a=BigInt(Math.round(performance.now()*1e6))}catch{a=0n}f.setBigUint64(i,a,!0)}else f.setBigUint64(i,0n,!0);return 0},fd_advise(n,s,i,f){return t.fds[n]!=null?g:_},fd_allocate(n,s,i){return t.fds[n]!=null?t.fds[n].fd_allocate(s,i):_},fd_close(n){if(t.fds[n]!=null){const s=t.fds[n].fd_close();return t.fds[n]=void 0,s}else return _},fd_datasync(n){return t.fds[n]!=null?t.fds[n].fd_sync():_},fd_fdstat_get(n,s){if(t.fds[n]!=null){const{ret:i,fdstat:f}=t.fds[n].fd_fdstat_get();return f!=null&&f.write_bytes(new DataView(t.inst.exports.memory.buffer),s),i}else return _},fd_fdstat_set_flags(n,s){return t.fds[n]!=null?t.fds[n].fd_fdstat_set_flags(s):_},fd_fdstat_set_rights(n,s,i){return t.fds[n]!=null?t.fds[n].fd_fdstat_set_rights(s,i):_},fd_filestat_get(n,s){if(t.fds[n]!=null){const{ret:i,filestat:f}=t.fds[n].fd_filestat_get();return f!=null&&f.write_bytes(new DataView(t.inst.exports.memory.buffer),s),i}else return _},fd_filestat_set_size(n,s){return t.fds[n]!=null?t.fds[n].fd_filestat_set_size(s):_},fd_filestat_set_times(n,s,i,f){return t.fds[n]!=null?t.fds[n].fd_filestat_set_times(s,i,f):_},fd_pread(n,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const d=O.read_bytes_array(u,s,i);let p=0;for(const c of d){const{ret:m,data:y}=t.fds[n].fd_pread(c.buf_len,f);if(m!=g)return u.setUint32(a,p,!0),m;if(h.set(y,c.buf),p+=y.length,f+=BigInt(y.length),y.length!=c.buf_len)break}return u.setUint32(a,p,!0),g}else return _},fd_prestat_get(n,s){const i=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:f,prestat:a}=t.fds[n].fd_prestat_get();return a!=null&&a.write_bytes(i,s),f}else return _},fd_prestat_dir_name(n,s,i){if(t.fds[n]!=null){const{ret:f,prestat:a}=t.fds[n].fd_prestat_get();if(a==null)return f;const u=a.inner.pr_name;return new Uint8Array(t.inst.exports.memory.buffer).set(u.slice(0,i),s),u.byteLength>i?ce:g}else return _},fd_pwrite(n,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const d=C.read_bytes_array(u,s,i);let p=0;for(const c of d){const m=h.slice(c.buf,c.buf+c.buf_len),{ret:y,nwritten:A}=t.fds[n].fd_pwrite(m,f);if(y!=g)return u.setUint32(a,p,!0),y;if(p+=A,f+=BigInt(A),A!=m.byteLength)break}return u.setUint32(a,p,!0),g}else return _},fd_read(n,s,i,f){const a=new DataView(t.inst.exports.memory.buffer),u=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const h=O.read_bytes_array(a,s,i);let d=0;for(const p of h){const{ret:c,data:m}=t.fds[n].fd_read(p.buf_len);if(c!=g)return a.setUint32(f,d,!0),c;if(u.set(m,p.buf),d+=m.length,m.length!=p.buf_len)break}return a.setUint32(f,d,!0),g}else return _},fd_readdir(n,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){let d=0;for(;;){const{ret:p,dirent:c}=t.fds[n].fd_readdir_single(f);if(p!=0)return u.setUint32(a,d,!0),p;if(c==null)break;if(i-d<c.head_length()){d=i;break}const m=new ArrayBuffer(c.head_length());if(c.write_head_bytes(new DataView(m),0),h.set(new Uint8Array(m).slice(0,Math.min(m.byteLength,i-d)),s),s+=c.head_length(),d+=c.head_length(),i-d<c.name_length()){d=i;break}c.write_name_bytes(h,s,i-d),s+=c.name_length(),d+=c.name_length(),f=c.d_next}return u.setUint32(a,d,!0),0}else return _},fd_renumber(n,s){if(t.fds[n]!=null&&t.fds[s]!=null){const i=t.fds[s].fd_close();return i!=0?i:(t.fds[s]=t.fds[n],t.fds[n]=void 0,0)}else return _},fd_seek(n,s,i,f){const a=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:u,offset:h}=t.fds[n].fd_seek(s,i);return a.setBigInt64(f,h,!0),u}else return _},fd_sync(n){return t.fds[n]!=null?t.fds[n].fd_sync():_},fd_tell(n,s){const i=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:f,offset:a}=t.fds[n].fd_tell();return i.setBigUint64(s,a,!0),f}else return _},fd_write(n,s,i,f){const a=new DataView(t.inst.exports.memory.buffer),u=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const h=C.read_bytes_array(a,s,i);let d=0;for(const p of h){const c=u.slice(p.buf,p.buf+p.buf_len),{ret:m,nwritten:y}=t.fds[n].fd_write(c);if(m!=g)return a.setUint32(f,d,!0),m;if(d+=y,y!=c.byteLength)break}return a.setUint32(f,d,!0),g}else return _},path_create_directory(n,s,i){const f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const a=new TextDecoder("utf-8").decode(f.slice(s,s+i));return t.fds[n].path_create_directory(a)}else return _},path_filestat_get(n,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const d=new TextDecoder("utf-8").decode(h.slice(i,i+f)),{ret:p,filestat:c}=t.fds[n].path_filestat_get(s,d);return c!=null&&c.write_bytes(u,a),p}else return _},path_filestat_set_times(n,s,i,f,a,u,h){const d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const p=new TextDecoder("utf-8").decode(d.slice(i,i+f));return t.fds[n].path_filestat_set_times(s,p,a,u,h)}else return _},path_link(n,s,i,f,a,u,h){const d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null&&t.fds[a]!=null){const p=new TextDecoder("utf-8").decode(d.slice(i,i+f)),c=new TextDecoder("utf-8").decode(d.slice(u,u+h)),{ret:m,inode_obj:y}=t.fds[n].path_lookup(p,s);return y==null?m:t.fds[a].path_link(c,y,!1)}else return _},path_open(n,s,i,f,a,u,h,d,p){const c=new DataView(t.inst.exports.memory.buffer),m=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const y=new TextDecoder("utf-8").decode(m.slice(i,i+f));U.log(y);const{ret:A,fd_obj:ue}=t.fds[n].path_open(s,y,a,u,h,d);if(A!=0)return A;t.fds.push(ue);const de=t.fds.length-1;return c.setUint32(p,de,!0),0}else return _},path_readlink(n,s,i,f,a,u){const h=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const p=new TextDecoder("utf-8").decode(d.slice(s,s+i));U.log(p);const{ret:c,data:m}=t.fds[n].path_readlink(p);if(m!=null){const y=new TextEncoder().encode(m);if(y.length>a)return h.setUint32(u,0,!0),_;d.set(y,f),h.setUint32(u,y.length,!0)}return c}else return _},path_remove_directory(n,s,i){const f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const a=new TextDecoder("utf-8").decode(f.slice(s,s+i));return t.fds[n].path_remove_directory(a)}else return _},path_rename(n,s,i,f,a,u){const h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null&&t.fds[f]!=null){const d=new TextDecoder("utf-8").decode(h.slice(s,s+i)),p=new TextDecoder("utf-8").decode(h.slice(a,a+u));let{ret:c,inode_obj:m}=t.fds[n].path_unlink(d);if(m==null)return c;if(c=t.fds[f].path_link(p,m,!0),c!=g&&t.fds[n].path_link(d,m,!0)!=g)throw"path_link should always return success when relinking an inode back to the original place";return c}else return _},path_symlink(n,s,i,f,a){const u=new Uint8Array(t.inst.exports.memory.buffer);return t.fds[i]!=null?(new TextDecoder("utf-8").decode(u.slice(n,n+s)),new TextDecoder("utf-8").decode(u.slice(f,f+a)),b):_},path_unlink_file(n,s,i){const f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const a=new TextDecoder("utf-8").decode(f.slice(s,s+i));return t.fds[n].path_unlink_file(a)}else return _},poll_oneoff(n,s,i){throw"async io not supported"},proc_exit(n){throw new ie(n)},proc_raise(n){throw"raised signal "+n},sched_yield(){},random_get(n,s){const i=new Uint8Array(t.inst.exports.memory.buffer).subarray(n,n+s);if("crypto"in globalThis&&(typeof SharedArrayBuffer>"u"||!(t.inst.exports.memory.buffer instanceof SharedArrayBuffer)))for(let f=0;f<s;f+=65536)crypto.getRandomValues(i.subarray(f,f+65536));else for(let f=0;f<s;f++)i[f]=Math.random()*256|0},sock_recv(n,s,i){throw"sockets not supported"},sock_send(n,s,i){throw"sockets not supported"},sock_shutdown(n,s){throw"sockets not supported"},sock_accept(n,s){throw"sockets not supported"}}}};class q{fd_allocate(e,r){return b}fd_close(){return 0}fd_fdstat_get(){return{ret:b,fdstat:null}}fd_fdstat_set_flags(e){return b}fd_fdstat_set_rights(e,r){return b}fd_filestat_get(){return{ret:b,filestat:null}}fd_filestat_set_size(e){return b}fd_filestat_set_times(e,r,o){return b}fd_pread(e,r){return{ret:b,data:new Uint8Array}}fd_prestat_get(){return{ret:b,prestat:null}}fd_pwrite(e,r){return{ret:b,nwritten:0}}fd_read(e){return{ret:b,data:new Uint8Array}}fd_readdir_single(e){return{ret:b,dirent:null}}fd_seek(e,r){return{ret:b,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:b,offset:0n}}fd_write(e){return{ret:b,nwritten:0}}path_create_directory(e){return b}path_filestat_get(e,r){return{ret:b,filestat:null}}path_filestat_set_times(e,r,o,l,t){return b}path_link(e,r,o){return b}path_unlink(e){return{ret:b,inode_obj:null}}path_lookup(e,r){return{ret:b,inode_obj:null}}path_open(e,r,o,l,t,n){return{ret:L,fd_obj:null}}path_readlink(e){return{ret:b,data:null}}path_remove_directory(e){return b}path_rename(e,r,o){return b}path_unlink_file(e){return b}}class I{static issue_ino(){return I.next_ino++}static root_ino(){return 0n}constructor(){this.ino=I.issue_ino()}}I.next_ino=1n;class oe extends q{fd_allocate(e,r){if(!(this.file.size>e+r)){const o=new Uint8Array(Number(e+r));o.set(this.file.data,0),this.file.data=o}return g}fd_fdstat_get(){return{ret:0,fdstat:new K(P,0)}}fd_filestat_set_size(e){if(this.file.size>e)this.file.data=new Uint8Array(this.file.data.buffer.slice(0,Number(e)));else{const r=new Uint8Array(Number(e));r.set(this.file.data,0),this.file.data=r}return g}fd_read(e){const r=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(e)));return this.file_pos+=BigInt(r.length),{ret:0,data:r}}fd_pread(e,r){return{ret:0,data:this.file.data.slice(Number(r),Number(r+BigInt(e)))}}fd_seek(e,r){let o;switch(r){case he:o=e;break;case pe:o=this.file_pos+e;break;case fe:o=BigInt(this.file.data.byteLength)+e;break;default:return{ret:V,offset:0n}}return o<0?{ret:V,offset:0n}:(this.file_pos=o,{ret:0,offset:this.file_pos})}fd_tell(){return{ret:0,offset:this.file_pos}}fd_write(e){if(this.file.readonly)return{ret:_,nwritten:0};if(this.file_pos+BigInt(e.byteLength)>this.file.size){const r=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(e.byteLength))),this.file.data.set(r)}return this.file.data.set(e,Number(this.file_pos)),this.file_pos+=BigInt(e.byteLength),{ret:0,nwritten:e.byteLength}}fd_pwrite(e,r){if(this.file.readonly)return{ret:_,nwritten:0};if(r+BigInt(e.byteLength)>this.file.size){const o=this.file.data;this.file.data=new Uint8Array(Number(r+BigInt(e.byteLength))),this.file.data.set(o)}return this.file.data.set(e,Number(r)),{ret:0,nwritten:e.byteLength}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(e){super(),this.file_pos=0n,this.file=e}}class ae extends q{fd_seek(e,r){return{ret:_,offset:0n}}fd_tell(){return{ret:_,offset:0n}}fd_allocate(e,r){return _}fd_fdstat_get(){return{ret:0,fdstat:new K(E,0)}}fd_readdir_single(e){if(U.enabled&&(U.log("readdir_single",e),U.log(e,this.dir.contents.keys())),e==0n)return{ret:g,dirent:new W(1n,this.dir.ino,".",E)};if(e==1n)return{ret:g,dirent:new W(2n,this.dir.parent_ino(),"..",E)};if(e>=BigInt(this.dir.contents.size)+2n)return{ret:0,dirent:null};const[r,o]=Array.from(this.dir.contents.entries())[Number(e-2n)];return{ret:0,dirent:new W(e+1n,o.ino,r,o.stat().filetype)}}path_filestat_get(e,r){const{ret:o,path:l}=B.from(r);if(l==null)return{ret:o,filestat:null};const{ret:t,entry:n}=this.dir.get_entry_for_path(l);return n==null?{ret:t,filestat:null}:{ret:0,filestat:n.stat()}}path_lookup(e,r){const{ret:o,path:l}=B.from(e);if(l==null)return{ret:o,inode_obj:null};const{ret:t,entry:n}=this.dir.get_entry_for_path(l);return n==null?{ret:t,inode_obj:null}:{ret:g,inode_obj:n}}path_open(e,r,o,l,t,n){const{ret:s,path:i}=B.from(r);if(i==null)return{ret:s,fd_obj:null};let{ret:f,entry:a}=this.dir.get_entry_for_path(i);if(a==null){if(f!=T)return{ret:f,fd_obj:null};if((o&G)==G){const{ret:u,entry:h}=this.dir.create_entry_for_path(r,(o&N)==N);if(h==null)return{ret:u,fd_obj:null};a=h}else return{ret:T,fd_obj:null}}else if((o&re)==re)return{ret:v,fd_obj:null};return(o&N)==N&&a.stat().filetype!==E?{ret:L,fd_obj:null}:a.path_open(o,l,n)}path_create_directory(e){return this.path_open(0,e,G|N,0n,0n,0).ret}path_link(e,r,o){const{ret:l,path:t}=B.from(e);if(t==null)return l;if(t.is_dir)return T;const{ret:n,parent_entry:s,filename:i,entry:f}=this.dir.get_parent_dir_and_entry_for_path(t,!0);if(s==null||i==null)return n;if(f!=null){const a=r.stat().filetype==E,u=f.stat().filetype==E;if(a&&u)if(o&&f instanceof D){if(f.contents.size!=0)return ee}else return v;else{if(a&&!u)return L;if(!a&&u)return Z;if(!(r.stat().filetype==P&&f.stat().filetype==P))return v}}return!o&&r.stat().filetype==E?Y:(s.contents.set(i,r),g)}path_unlink(e){const{ret:r,path:o}=B.from(e);if(o==null)return{ret:r,inode_obj:null};const{ret:l,parent_entry:t,filename:n,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!0);return t==null||n==null?{ret:l,inode_obj:null}:s==null?{ret:T,inode_obj:null}:(t.contents.delete(n),{ret:g,inode_obj:s})}path_unlink_file(e){const{ret:r,path:o}=B.from(e);if(o==null)return r;const{ret:l,parent_entry:t,filename:n,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!1);return t==null||n==null||s==null?l:s.stat().filetype===E?Z:(t.contents.delete(n),g)}path_remove_directory(e){const{ret:r,path:o}=B.from(e);if(o==null)return r;const{ret:l,parent_entry:t,filename:n,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!1);return t==null||n==null||s==null?l:!(s instanceof D)||s.stat().filetype!==E?L:s.contents.size!==0?ee:t.contents.delete(n)?g:T}fd_filestat_get(){return{ret:0,filestat:this.dir.stat()}}fd_filestat_set_size(e){return _}fd_read(e){return{ret:_,data:new Uint8Array}}fd_pread(e,r){return{ret:_,data:new Uint8Array}}fd_write(e){return{ret:_,nwritten:0}}fd_pwrite(e,r){return{ret:_,nwritten:0}}constructor(e){super(),this.dir=e}}class Ue extends ae{fd_prestat_get(){return{ret:0,prestat:X.dir(this.prestat_name)}}constructor(e,r){super(new D(r)),this.prestat_name=e}}class j extends I{path_open(e,r,o){if(this.readonly&&(r&BigInt(H))==BigInt(H))return{ret:Y,fd_obj:null};if((e&se)==se){if(this.readonly)return{ret:Y,fd_obj:null};this.data=new Uint8Array([])}const l=new oe(this);return o&ye&&l.fd_seek(0n,fe),{ret:g,fd_obj:l}}get size(){return BigInt(this.data.byteLength)}stat(){return new $(this.ino,P,this.size)}constructor(e,r){super(),this.data=new Uint8Array(e),this.readonly=!!(r!=null&&r.readonly)}}let B=class le{static from(e){const r=new le;if(r.is_dir=e.endsWith("/"),e.startsWith("/"))return{ret:te,path:null};if(e.includes("\0"))return{ret:V,path:null};for(const o of e.split("/"))if(!(o===""||o===".")){if(o===".."){if(r.parts.pop()==null)return{ret:te,path:null};continue}r.parts.push(o)}return{ret:g,path:r}}to_path_string(){let e=this.parts.join("/");return this.is_dir&&(e+="/"),e}constructor(){this.parts=[],this.is_dir=!1}};class D extends I{parent_ino(){return this.parent==null?I.root_ino():this.parent.ino}path_open(e,r,o){return{ret:g,fd_obj:new ae(this)}}stat(){return new $(this.ino,E,0n)}get_entry_for_path(e){let r=this;for(const o of e.parts){if(!(r instanceof D))return{ret:L,entry:null};const l=r.contents.get(o);if(l!==void 0)r=l;else return U.log(o),{ret:T,entry:null}}return e.is_dir&&r.stat().filetype!=E?{ret:L,entry:null}:{ret:g,entry:r}}get_parent_dir_and_entry_for_path(e,r){const o=e.parts.pop();if(o===void 0)return{ret:V,parent_entry:null,filename:null,entry:null};const{ret:l,entry:t}=this.get_entry_for_path(e);if(t==null)return{ret:l,parent_entry:null,filename:null,entry:null};if(!(t instanceof D))return{ret:L,parent_entry:null,filename:null,entry:null};const n=t.contents.get(o);return n===void 0?r?{ret:g,parent_entry:t,filename:o,entry:null}:{ret:T,parent_entry:null,filename:null,entry:null}:e.is_dir&&n.stat().filetype!=E?{ret:L,parent_entry:null,filename:null,entry:null}:{ret:g,parent_entry:t,filename:o,entry:n}}create_entry_for_path(e,r){const{ret:o,path:l}=B.from(e);if(l==null)return{ret:o,entry:null};let{ret:t,parent_entry:n,filename:s,entry:i}=this.get_parent_dir_and_entry_for_path(l,!0);if(n==null||s==null)return{ret:t,entry:null};if(i!=null)return{ret:v,entry:null};U.log("create",l);let f;return r?f=new D(new Map):f=new j(new ArrayBuffer(0)),n.contents.set(s,f),i=f,{ret:g,entry:i}}constructor(e){super(),this.parent=null,e instanceof Array?this.contents=new Map(e):this.contents=e;for(const r of this.contents.values())r instanceof D&&(r.parent=this)}}class F extends q{fd_filestat_get(){return{ret:0,filestat:new $(this.ino,ne,BigInt(0))}}fd_fdstat_get(){const e=new K(ne,0);return e.fs_rights_base=BigInt(H),{ret:0,fdstat:e}}fd_write(e){return this.write(e),{ret:0,nwritten:e.byteLength}}static lineBuffered(e){const r=new TextDecoder("utf-8",{fatal:!1});let o="";return new F(l=>{o+=r.decode(l,{stream:!0});const t=o.split(`
`);for(const[n,s]of t.entries())n<t.length-1?e(s):o=s})}constructor(e){super(),this.ino=I.issue_ino(),this.write=e}}async function Ee(w,e){const r=new j(w,"input.docx",{readonly:!0}),o=new j(new Uint8Array,"output.html",{readonly:!1}),l=[new oe(new j(new Uint8Array,{readonly:!0})),F.lineBuffered(y=>e.textContent+=`[stdout] ${y}
`),F.lineBuffered(y=>e.textContent+=`[stderr] ${y}
`),new Ue("/",[["in",r],["out",o]])],t=["pandoc.wasm","+RTS","-H64m","-RTS"],n=new xe(t,[],l,{debug:!1}),{instance:s}=await WebAssembly.instantiateStreaming(fetch("https://tweag.github.io/pandoc-wasm/pandoc.wasm"),{wasi_snapshot_preview1:n.wasiImport});n.initialize(s),s.exports.__wasm_call_ctors(),new TextEncoder;const i="-f docx -t html";function f(){return new DataView(s.exports.memory.buffer)}const a=s.exports.malloc(4);f().setUint32(a,t.length,!0);const u=s.exports.malloc(4*(t.length+1));for(let y=0;y<t.length;++y){const A=s.exports.malloc(t[y].length+1);new TextEncoder().encodeInto(t[y],new Uint8Array(s.exports.memory.buffer,A,t[y].length)),f().setUint8(A+t[y].length,0),f().setUint32(u+4*y,A,!0)}f().setUint32(u+4*t.length,0,!0);const h=s.exports.malloc(4);f().setUint32(h,u,!0),s.exports.hs_init_with_rtsopts(a,h);const d=new TextEncoder().encode(i),p=s.exports.malloc(d.length+1),c=new Uint8Array(s.exports.memory.buffer,p,d.length+1);c.set(d),c[d.length]=0,s.exports.wasm_main(p,d.length);const m=o.data;return new TextDecoder().decode(m)}const z=document.getElementById("instructions"),x=document.getElementById("output"),M=document.getElementById("btn-group"),k=document.getElementById("form-convert"),R=document.getElementById("upload");R.addEventListener("change",()=>{R.files&&R.files.length>0?(k.disabled=!1,k.classList.remove("disabled")):(k.disabled=!0,k.classList.add("disabled"))});const Ae=document.getElementById("success-modal"),Be=document.getElementById("copy");Be.addEventListener("click",()=>{x.textContent&&(navigator.clipboard.writeText(x.textContent).then(()=>{Ae.showModal()}),x.focus())});const Le=document.getElementById("minify");Le.addEventListener("click",()=>{if(x.textContent){const w=x.textContent.replace(/\s+/g," ").trim();x.textContent=w}else x.textContent="No output to minify."});const De=document.getElementById("convert-another");De.addEventListener("click",()=>{S.classList.remove("hidden"),R.value="",x.classList.add("hidden"),x.textContent="",M.classList.add("hidden"),M.classList.remove("flex"),z.classList.remove("hidden")});const Ie=document.getElementById("download");Ie.addEventListener("click",()=>{if(x.textContent){const w=new Blob([x.textContent],{type:"text/html"}),e=URL.createObjectURL(w),r=document.createElement("a");r.href=e,r.download="output.html",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(e)}else alert("No output to download.")});const S=document.getElementById("upload-form");S.addEventListener("submit",async w=>{var o;w.preventDefault(),x.textContent="",R.disabled=!0,k.disabled=!0,z.disabled=!0;const e=(o=R.files)==null?void 0:o[0];if(!e)return;const r=new Uint8Array(await e.arrayBuffer());try{const l=await Ee(r,x);x.classList.remove("hidden"),M.classList.remove("hidden"),M.classList.add("flex"),S.classList.add("hidden"),S.classList.remove("flex"),z.classList.add("hidden"),z.disabled=!1,x.textContent+=l,R.disabled=!1,k.disabled=!0}catch(l){x.textContent=`Error: ${l.message}`,x.classList.remove("hidden")}});
