(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const t of l)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function r(l){const t={};return l.integrity&&(t.integrity=l.integrity),l.referrerPolicy&&(t.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?t.credentials="include":l.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(l){if(l.ep)return;l.ep=!0;const t=r(l);fetch(l.href,t)}})();const q=0,J=1,m=0,c=8,v=20,S=28,Q=31,ce=37,I=44,_e=52,B=54,Z=55,g=58,G=63,ee=76,Y=64;class k{static read_bytes(e,r){const o=new k;return o.buf=e.getUint32(r,!0),o.buf_len=e.getUint32(r+4,!0),o}static read_bytes_array(e,r,o){const l=[];for(let t=0;t<o;t++)l.push(k.read_bytes(e,r+8*t));return l}}class O{static read_bytes(e,r){const o=new O;return o.buf=e.getUint32(r,!0),o.buf_len=e.getUint32(r+4,!0),o}static read_bytes_array(e,r,o){const l=[];for(let t=0;t<o;t++)l.push(O.read_bytes(e,r+8*t));return l}}const he=0,pe=1,ie=2,te=2,E=3,V=4;class M{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(e,r){e.setBigUint64(r,this.d_next,!0),e.setBigUint64(r+8,this.d_ino,!0),e.setUint32(r+16,this.dir_name.length,!0),e.setUint8(r+20,this.d_type)}write_name_bytes(e,r,o){e.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,o)),r)}constructor(e,r,o,l){const t=new TextEncoder().encode(o);this.d_next=e,this.d_ino=r,this.d_namlen=t.byteLength,this.d_type=l,this.dir_name=t}}const ye=1;class H{write_bytes(e,r){e.setUint8(r,this.fs_filetype),e.setUint16(r+2,this.fs_flags,!0),e.setBigUint64(r+8,this.fs_rights_base,!0),e.setBigUint64(r+16,this.fs_rights_inherited,!0)}constructor(e,r){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=e,this.fs_flags=r}}const W=1,R=2,ne=4,re=8;class K{write_bytes(e,r){e.setBigUint64(r,this.dev,!0),e.setBigUint64(r+8,this.ino,!0),e.setUint8(r+16,this.filetype),e.setBigUint64(r+24,this.nlink,!0),e.setBigUint64(r+32,this.size,!0),e.setBigUint64(r+38,this.atim,!0),e.setBigUint64(r+46,this.mtim,!0),e.setBigUint64(r+52,this.ctim,!0)}constructor(e,r,o){this.dev=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.ino=e,this.filetype=r,this.size=o}}const me=0;class ge{write_bytes(e,r){e.setUint32(r,this.pr_name.byteLength,!0)}constructor(e){this.pr_name=new TextEncoder().encode(e)}}class ${static dir(e){const r=new $;return r.tag=me,r.inner=new ge(e),r}write_bytes(e,r){e.setUint32(r,this.tag,!0),this.inner.write_bytes(e,r+4)}}let be=class{enable(e){this.log=we(e===void 0?!0:e,this.prefix)}get enabled(){return this.isEnabled}constructor(e){this.isEnabled=e,this.prefix="wasi:",this.enable(e)}};function we(w,e){return w?console.log.bind(console,"%c%s","color: #265BA0",e):()=>{}}const U=new be(!1);class se extends Error{constructor(e){super("exit with exit code "+e),this.code=e}}let xe=class{start(e){this.inst=e;try{return e.exports._start(),0}catch(r){if(r instanceof se)return r.code;throw r}}initialize(e){this.inst=e,e.exports._initialize&&e.exports._initialize()}constructor(e,r,o,l={}){this.args=[],this.env=[],this.fds=[],U.enable(l.debug),this.args=e,this.env=r,this.fds=o;const t=this;this.wasiImport={args_sizes_get(n,s){const i=new DataView(t.inst.exports.memory.buffer);i.setUint32(n,t.args.length,!0);let f=0;for(const a of t.args)f+=a.length+1;return i.setUint32(s,f,!0),U.log(i.getUint32(n,!0),i.getUint32(s,!0)),0},args_get(n,s){const i=new DataView(t.inst.exports.memory.buffer),f=new Uint8Array(t.inst.exports.memory.buffer),a=s;for(let u=0;u<t.args.length;u++){i.setUint32(n,s,!0),n+=4;const d=new TextEncoder().encode(t.args[u]);f.set(d,s),i.setUint8(s+d.length,0),s+=d.length+1}return U.enabled&&U.log(new TextDecoder("utf-8").decode(f.slice(a,s))),0},environ_sizes_get(n,s){const i=new DataView(t.inst.exports.memory.buffer);i.setUint32(n,t.env.length,!0);let f=0;for(const a of t.env)f+=a.length+1;return i.setUint32(s,f,!0),U.log(i.getUint32(n,!0),i.getUint32(s,!0)),0},environ_get(n,s){const i=new DataView(t.inst.exports.memory.buffer),f=new Uint8Array(t.inst.exports.memory.buffer),a=s;for(let u=0;u<t.env.length;u++){i.setUint32(n,s,!0),n+=4;const d=new TextEncoder().encode(t.env[u]);f.set(d,s),i.setUint8(s+d.length,0),s+=d.length+1}return U.enabled&&U.log(new TextDecoder("utf-8").decode(f.slice(a,s))),0},clock_res_get(n,s){let i;switch(n){case J:{i=5000n;break}case q:{i=1000000n;break}default:return _e}return new DataView(t.inst.exports.memory.buffer).setBigUint64(s,i,!0),m},clock_time_get(n,s,i){const f=new DataView(t.inst.exports.memory.buffer);if(n===q)f.setBigUint64(i,BigInt(new Date().getTime())*1000000n,!0);else if(n==J){let a;try{a=BigInt(Math.round(performance.now()*1e6))}catch{a=0n}f.setBigUint64(i,a,!0)}else f.setBigUint64(i,0n,!0);return 0},fd_advise(n,s,i,f){return t.fds[n]!=null?m:c},fd_allocate(n,s,i){return t.fds[n]!=null?t.fds[n].fd_allocate(s,i):c},fd_close(n){if(t.fds[n]!=null){const s=t.fds[n].fd_close();return t.fds[n]=void 0,s}else return c},fd_datasync(n){return t.fds[n]!=null?t.fds[n].fd_sync():c},fd_fdstat_get(n,s){if(t.fds[n]!=null){const{ret:i,fdstat:f}=t.fds[n].fd_fdstat_get();return f!=null&&f.write_bytes(new DataView(t.inst.exports.memory.buffer),s),i}else return c},fd_fdstat_set_flags(n,s){return t.fds[n]!=null?t.fds[n].fd_fdstat_set_flags(s):c},fd_fdstat_set_rights(n,s,i){return t.fds[n]!=null?t.fds[n].fd_fdstat_set_rights(s,i):c},fd_filestat_get(n,s){if(t.fds[n]!=null){const{ret:i,filestat:f}=t.fds[n].fd_filestat_get();return f!=null&&f.write_bytes(new DataView(t.inst.exports.memory.buffer),s),i}else return c},fd_filestat_set_size(n,s){return t.fds[n]!=null?t.fds[n].fd_filestat_set_size(s):c},fd_filestat_set_times(n,s,i,f){return t.fds[n]!=null?t.fds[n].fd_filestat_set_times(s,i,f):c},fd_pread(n,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const h=k.read_bytes_array(u,s,i);let y=0;for(const _ of h){const{ret:p,data:b}=t.fds[n].fd_pread(_.buf_len,f);if(p!=m)return u.setUint32(a,y,!0),p;if(d.set(b,_.buf),y+=b.length,f+=BigInt(b.length),b.length!=_.buf_len)break}return u.setUint32(a,y,!0),m}else return c},fd_prestat_get(n,s){const i=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:f,prestat:a}=t.fds[n].fd_prestat_get();return a!=null&&a.write_bytes(i,s),f}else return c},fd_prestat_dir_name(n,s,i){if(t.fds[n]!=null){const{ret:f,prestat:a}=t.fds[n].fd_prestat_get();if(a==null)return f;const u=a.inner.pr_name;return new Uint8Array(t.inst.exports.memory.buffer).set(u.slice(0,i),s),u.byteLength>i?ce:m}else return c},fd_pwrite(n,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const h=O.read_bytes_array(u,s,i);let y=0;for(const _ of h){const p=d.slice(_.buf,_.buf+_.buf_len),{ret:b,nwritten:T}=t.fds[n].fd_pwrite(p,f);if(b!=m)return u.setUint32(a,y,!0),b;if(y+=T,f+=BigInt(T),T!=p.byteLength)break}return u.setUint32(a,y,!0),m}else return c},fd_read(n,s,i,f){const a=new DataView(t.inst.exports.memory.buffer),u=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const d=k.read_bytes_array(a,s,i);let h=0;for(const y of d){const{ret:_,data:p}=t.fds[n].fd_read(y.buf_len);if(_!=m)return a.setUint32(f,h,!0),_;if(u.set(p,y.buf),h+=p.length,p.length!=y.buf_len)break}return a.setUint32(f,h,!0),m}else return c},fd_readdir(n,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){let h=0;for(;;){const{ret:y,dirent:_}=t.fds[n].fd_readdir_single(f);if(y!=0)return u.setUint32(a,h,!0),y;if(_==null)break;if(i-h<_.head_length()){h=i;break}const p=new ArrayBuffer(_.head_length());if(_.write_head_bytes(new DataView(p),0),d.set(new Uint8Array(p).slice(0,Math.min(p.byteLength,i-h)),s),s+=_.head_length(),h+=_.head_length(),i-h<_.name_length()){h=i;break}_.write_name_bytes(d,s,i-h),s+=_.name_length(),h+=_.name_length(),f=_.d_next}return u.setUint32(a,h,!0),0}else return c},fd_renumber(n,s){if(t.fds[n]!=null&&t.fds[s]!=null){const i=t.fds[s].fd_close();return i!=0?i:(t.fds[s]=t.fds[n],t.fds[n]=void 0,0)}else return c},fd_seek(n,s,i,f){const a=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:u,offset:d}=t.fds[n].fd_seek(s,i);return a.setBigInt64(f,d,!0),u}else return c},fd_sync(n){return t.fds[n]!=null?t.fds[n].fd_sync():c},fd_tell(n,s){const i=new DataView(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const{ret:f,offset:a}=t.fds[n].fd_tell();return i.setBigUint64(s,a,!0),f}else return c},fd_write(n,s,i,f){const a=new DataView(t.inst.exports.memory.buffer),u=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const d=O.read_bytes_array(a,s,i);let h=0;for(const y of d){const _=u.slice(y.buf,y.buf+y.buf_len),{ret:p,nwritten:b}=t.fds[n].fd_write(_);if(p!=m)return a.setUint32(f,h,!0),p;if(h+=b,b!=_.byteLength)break}return a.setUint32(f,h,!0),m}else return c},path_create_directory(n,s,i){const f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const a=new TextDecoder("utf-8").decode(f.slice(s,s+i));return t.fds[n].path_create_directory(a)}else return c},path_filestat_get(n,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const h=new TextDecoder("utf-8").decode(d.slice(i,i+f)),{ret:y,filestat:_}=t.fds[n].path_filestat_get(s,h);return _!=null&&_.write_bytes(u,a),y}else return c},path_filestat_set_times(n,s,i,f,a,u,d){const h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const y=new TextDecoder("utf-8").decode(h.slice(i,i+f));return t.fds[n].path_filestat_set_times(s,y,a,u,d)}else return c},path_link(n,s,i,f,a,u,d){const h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null&&t.fds[a]!=null){const y=new TextDecoder("utf-8").decode(h.slice(i,i+f)),_=new TextDecoder("utf-8").decode(h.slice(u,u+d)),{ret:p,inode_obj:b}=t.fds[n].path_lookup(y,s);return b==null?p:t.fds[a].path_link(_,b,!1)}else return c},path_open(n,s,i,f,a,u,d,h,y){const _=new DataView(t.inst.exports.memory.buffer),p=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const b=new TextDecoder("utf-8").decode(p.slice(i,i+f));U.log(b);const{ret:T,fd_obj:ue}=t.fds[n].path_open(s,b,a,u,d,h);if(T!=0)return T;t.fds.push(ue);const de=t.fds.length-1;return _.setUint32(y,de,!0),0}else return c},path_readlink(n,s,i,f,a,u){const d=new DataView(t.inst.exports.memory.buffer),h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const y=new TextDecoder("utf-8").decode(h.slice(s,s+i));U.log(y);const{ret:_,data:p}=t.fds[n].path_readlink(y);if(p!=null){const b=new TextEncoder().encode(p);if(b.length>a)return d.setUint32(u,0,!0),c;h.set(b,f),d.setUint32(u,b.length,!0)}return _}else return c},path_remove_directory(n,s,i){const f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const a=new TextDecoder("utf-8").decode(f.slice(s,s+i));return t.fds[n].path_remove_directory(a)}else return c},path_rename(n,s,i,f,a,u){const d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null&&t.fds[f]!=null){const h=new TextDecoder("utf-8").decode(d.slice(s,s+i)),y=new TextDecoder("utf-8").decode(d.slice(a,a+u));let{ret:_,inode_obj:p}=t.fds[n].path_unlink(h);if(p==null)return _;if(_=t.fds[f].path_link(y,p,!0),_!=m&&t.fds[n].path_link(h,p,!0)!=m)throw"path_link should always return success when relinking an inode back to the original place";return _}else return c},path_symlink(n,s,i,f,a){const u=new Uint8Array(t.inst.exports.memory.buffer);return t.fds[i]!=null?(new TextDecoder("utf-8").decode(u.slice(n,n+s)),new TextDecoder("utf-8").decode(u.slice(f,f+a)),g):c},path_unlink_file(n,s,i){const f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[n]!=null){const a=new TextDecoder("utf-8").decode(f.slice(s,s+i));return t.fds[n].path_unlink_file(a)}else return c},poll_oneoff(n,s,i){throw"async io not supported"},proc_exit(n){throw new se(n)},proc_raise(n){throw"raised signal "+n},sched_yield(){},random_get(n,s){const i=new Uint8Array(t.inst.exports.memory.buffer).subarray(n,n+s);if("crypto"in globalThis&&(typeof SharedArrayBuffer>"u"||!(t.inst.exports.memory.buffer instanceof SharedArrayBuffer)))for(let f=0;f<s;f+=65536)crypto.getRandomValues(i.subarray(f,f+65536));else for(let f=0;f<s;f++)i[f]=Math.random()*256|0},sock_recv(n,s,i){throw"sockets not supported"},sock_send(n,s,i){throw"sockets not supported"},sock_shutdown(n,s){throw"sockets not supported"},sock_accept(n,s){throw"sockets not supported"}}}};class X{fd_allocate(e,r){return g}fd_close(){return 0}fd_fdstat_get(){return{ret:g,fdstat:null}}fd_fdstat_set_flags(e){return g}fd_fdstat_set_rights(e,r){return g}fd_filestat_get(){return{ret:g,filestat:null}}fd_filestat_set_size(e){return g}fd_filestat_set_times(e,r,o){return g}fd_pread(e,r){return{ret:g,data:new Uint8Array}}fd_prestat_get(){return{ret:g,prestat:null}}fd_pwrite(e,r){return{ret:g,nwritten:0}}fd_read(e){return{ret:g,data:new Uint8Array}}fd_readdir_single(e){return{ret:g,dirent:null}}fd_seek(e,r){return{ret:g,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:g,offset:0n}}fd_write(e){return{ret:g,nwritten:0}}path_create_directory(e){return g}path_filestat_get(e,r){return{ret:g,filestat:null}}path_filestat_set_times(e,r,o,l,t){return g}path_link(e,r,o){return g}path_unlink(e){return{ret:g,inode_obj:null}}path_lookup(e,r){return{ret:g,inode_obj:null}}path_open(e,r,o,l,t,n){return{ret:B,fd_obj:null}}path_readlink(e){return{ret:g,data:null}}path_remove_directory(e){return g}path_rename(e,r,o){return g}path_unlink_file(e){return g}}class D{static issue_ino(){return D.next_ino++}static root_ino(){return 0n}constructor(){this.ino=D.issue_ino()}}D.next_ino=1n;class fe extends X{fd_allocate(e,r){if(!(this.file.size>e+r)){const o=new Uint8Array(Number(e+r));o.set(this.file.data,0),this.file.data=o}return m}fd_fdstat_get(){return{ret:0,fdstat:new H(V,0)}}fd_filestat_set_size(e){if(this.file.size>e)this.file.data=new Uint8Array(this.file.data.buffer.slice(0,Number(e)));else{const r=new Uint8Array(Number(e));r.set(this.file.data,0),this.file.data=r}return m}fd_read(e){const r=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(e)));return this.file_pos+=BigInt(r.length),{ret:0,data:r}}fd_pread(e,r){return{ret:0,data:this.file.data.slice(Number(r),Number(r+BigInt(e)))}}fd_seek(e,r){let o;switch(r){case he:o=e;break;case pe:o=this.file_pos+e;break;case ie:o=BigInt(this.file.data.byteLength)+e;break;default:return{ret:S,offset:0n}}return o<0?{ret:S,offset:0n}:(this.file_pos=o,{ret:0,offset:this.file_pos})}fd_tell(){return{ret:0,offset:this.file_pos}}fd_write(e){if(this.file.readonly)return{ret:c,nwritten:0};if(this.file_pos+BigInt(e.byteLength)>this.file.size){const r=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(e.byteLength))),this.file.data.set(r)}return this.file.data.set(e,Number(this.file_pos)),this.file_pos+=BigInt(e.byteLength),{ret:0,nwritten:e.byteLength}}fd_pwrite(e,r){if(this.file.readonly)return{ret:c,nwritten:0};if(r+BigInt(e.byteLength)>this.file.size){const o=this.file.data;this.file.data=new Uint8Array(Number(r+BigInt(e.byteLength))),this.file.data.set(o)}return this.file.data.set(e,Number(r)),{ret:0,nwritten:e.byteLength}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(e){super(),this.file_pos=0n,this.file=e}}class oe extends X{fd_seek(e,r){return{ret:c,offset:0n}}fd_tell(){return{ret:c,offset:0n}}fd_allocate(e,r){return c}fd_fdstat_get(){return{ret:0,fdstat:new H(E,0)}}fd_readdir_single(e){if(U.enabled&&(U.log("readdir_single",e),U.log(e,this.dir.contents.keys())),e==0n)return{ret:m,dirent:new M(1n,this.dir.ino,".",E)};if(e==1n)return{ret:m,dirent:new M(2n,this.dir.parent_ino(),"..",E)};if(e>=BigInt(this.dir.contents.size)+2n)return{ret:0,dirent:null};const[r,o]=Array.from(this.dir.contents.entries())[Number(e-2n)];return{ret:0,dirent:new M(e+1n,o.ino,r,o.stat().filetype)}}path_filestat_get(e,r){const{ret:o,path:l}=A.from(r);if(l==null)return{ret:o,filestat:null};const{ret:t,entry:n}=this.dir.get_entry_for_path(l);return n==null?{ret:t,filestat:null}:{ret:0,filestat:n.stat()}}path_lookup(e,r){const{ret:o,path:l}=A.from(e);if(l==null)return{ret:o,inode_obj:null};const{ret:t,entry:n}=this.dir.get_entry_for_path(l);return n==null?{ret:t,inode_obj:null}:{ret:m,inode_obj:n}}path_open(e,r,o,l,t,n){const{ret:s,path:i}=A.from(r);if(i==null)return{ret:s,fd_obj:null};let{ret:f,entry:a}=this.dir.get_entry_for_path(i);if(a==null){if(f!=I)return{ret:f,fd_obj:null};if((o&W)==W){const{ret:u,entry:d}=this.dir.create_entry_for_path(r,(o&R)==R);if(d==null)return{ret:u,fd_obj:null};a=d}else return{ret:I,fd_obj:null}}else if((o&ne)==ne)return{ret:v,fd_obj:null};return(o&R)==R&&a.stat().filetype!==E?{ret:B,fd_obj:null}:a.path_open(o,l,n)}path_create_directory(e){return this.path_open(0,e,W|R,0n,0n,0).ret}path_link(e,r,o){const{ret:l,path:t}=A.from(e);if(t==null)return l;if(t.is_dir)return I;const{ret:n,parent_entry:s,filename:i,entry:f}=this.dir.get_parent_dir_and_entry_for_path(t,!0);if(s==null||i==null)return n;if(f!=null){const a=r.stat().filetype==E,u=f.stat().filetype==E;if(a&&u)if(o&&f instanceof L){if(f.contents.size!=0)return Z}else return v;else{if(a&&!u)return B;if(!a&&u)return Q;if(!(r.stat().filetype==V&&f.stat().filetype==V))return v}}return!o&&r.stat().filetype==E?G:(s.contents.set(i,r),m)}path_unlink(e){const{ret:r,path:o}=A.from(e);if(o==null)return{ret:r,inode_obj:null};const{ret:l,parent_entry:t,filename:n,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!0);return t==null||n==null?{ret:l,inode_obj:null}:s==null?{ret:I,inode_obj:null}:(t.contents.delete(n),{ret:m,inode_obj:s})}path_unlink_file(e){const{ret:r,path:o}=A.from(e);if(o==null)return r;const{ret:l,parent_entry:t,filename:n,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!1);return t==null||n==null||s==null?l:s.stat().filetype===E?Q:(t.contents.delete(n),m)}path_remove_directory(e){const{ret:r,path:o}=A.from(e);if(o==null)return r;const{ret:l,parent_entry:t,filename:n,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!1);return t==null||n==null||s==null?l:!(s instanceof L)||s.stat().filetype!==E?B:s.contents.size!==0?Z:t.contents.delete(n)?m:I}fd_filestat_get(){return{ret:0,filestat:this.dir.stat()}}fd_filestat_set_size(e){return c}fd_read(e){return{ret:c,data:new Uint8Array}}fd_pread(e,r){return{ret:c,data:new Uint8Array}}fd_write(e){return{ret:c,nwritten:0}}fd_pwrite(e,r){return{ret:c,nwritten:0}}constructor(e){super(),this.dir=e}}class Ue extends oe{fd_prestat_get(){return{ret:0,prestat:$.dir(this.prestat_name)}}constructor(e,r){super(new L(r)),this.prestat_name=e}}class j extends D{path_open(e,r,o){if(this.readonly&&(r&BigInt(Y))==BigInt(Y))return{ret:G,fd_obj:null};if((e&re)==re){if(this.readonly)return{ret:G,fd_obj:null};this.data=new Uint8Array([])}const l=new fe(this);return o&ye&&l.fd_seek(0n,ie),{ret:m,fd_obj:l}}get size(){return BigInt(this.data.byteLength)}stat(){return new K(this.ino,V,this.size)}constructor(e,r){super(),this.data=new Uint8Array(e),this.readonly=!!(r!=null&&r.readonly)}}let A=class ae{static from(e){const r=new ae;if(r.is_dir=e.endsWith("/"),e.startsWith("/"))return{ret:ee,path:null};if(e.includes("\0"))return{ret:S,path:null};for(const o of e.split("/"))if(!(o===""||o===".")){if(o===".."){if(r.parts.pop()==null)return{ret:ee,path:null};continue}r.parts.push(o)}return{ret:m,path:r}}to_path_string(){let e=this.parts.join("/");return this.is_dir&&(e+="/"),e}constructor(){this.parts=[],this.is_dir=!1}};class L extends D{parent_ino(){return this.parent==null?D.root_ino():this.parent.ino}path_open(e,r,o){return{ret:m,fd_obj:new oe(this)}}stat(){return new K(this.ino,E,0n)}get_entry_for_path(e){let r=this;for(const o of e.parts){if(!(r instanceof L))return{ret:B,entry:null};const l=r.contents.get(o);if(l!==void 0)r=l;else return U.log(o),{ret:I,entry:null}}return e.is_dir&&r.stat().filetype!=E?{ret:B,entry:null}:{ret:m,entry:r}}get_parent_dir_and_entry_for_path(e,r){const o=e.parts.pop();if(o===void 0)return{ret:S,parent_entry:null,filename:null,entry:null};const{ret:l,entry:t}=this.get_entry_for_path(e);if(t==null)return{ret:l,parent_entry:null,filename:null,entry:null};if(!(t instanceof L))return{ret:B,parent_entry:null,filename:null,entry:null};const n=t.contents.get(o);return n===void 0?r?{ret:m,parent_entry:t,filename:o,entry:null}:{ret:I,parent_entry:null,filename:null,entry:null}:e.is_dir&&n.stat().filetype!=E?{ret:B,parent_entry:null,filename:null,entry:null}:{ret:m,parent_entry:t,filename:o,entry:n}}create_entry_for_path(e,r){const{ret:o,path:l}=A.from(e);if(l==null)return{ret:o,entry:null};let{ret:t,parent_entry:n,filename:s,entry:i}=this.get_parent_dir_and_entry_for_path(l,!0);if(n==null||s==null)return{ret:t,entry:null};if(i!=null)return{ret:v,entry:null};U.log("create",l);let f;return r?f=new L(new Map):f=new j(new ArrayBuffer(0)),n.contents.set(s,f),i=f,{ret:m,entry:i}}constructor(e){super(),this.parent=null,e instanceof Array?this.contents=new Map(e):this.contents=e;for(const r of this.contents.values())r instanceof L&&(r.parent=this)}}class P extends X{fd_filestat_get(){return{ret:0,filestat:new K(this.ino,te,BigInt(0))}}fd_fdstat_get(){const e=new H(te,0);return e.fs_rights_base=BigInt(Y),{ret:0,fdstat:e}}fd_write(e){return this.write(e),{ret:0,nwritten:e.byteLength}}static lineBuffered(e){const r=new TextDecoder("utf-8",{fatal:!1});let o="";return new P(l=>{o+=r.decode(l,{stream:!0});const t=o.split(`
`);for(const[n,s]of t.entries())n<t.length-1?e(s):o=s})}constructor(e){super(),this.ino=D.issue_ino(),this.write=e}}const le=document.getElementById("instructions"),z=document.getElementById("upload-form"),x=document.getElementById("output");let N=document.getElementById("upload");const F=document.getElementById("btn-group"),Ee=document.getElementById("convert-another"),C=document.getElementById("form-convert");N.addEventListener("change",()=>{N.files&&N.files.length>0?(C.disabled=!1,C.classList.remove("disabled")):(C.disabled=!0,C.classList.add("disabled"))});const Ae=document.getElementById("success-modal"),Be=document.getElementById("minify"),Le=document.getElementById("copy");Le.addEventListener("click",()=>{x.textContent?navigator.clipboard.writeText(x.textContent).then(()=>{Ae.showModal()}):alert("No output to copy.")});Be.addEventListener("click",()=>{if(x.textContent){const w=x.textContent.replace(/\s+/g," ").trim();x.textContent=w}else x.textContent="No output to minify."});Ee.addEventListener("click",()=>{z.classList.remove("hidden"),N.value="",x.classList.add("hidden"),x.textContent="",F.classList.add("hidden"),F.classList.remove("flex"),le.classList.remove("hidden")});const De=document.getElementById("download");De.addEventListener("click",()=>{if(x.textContent){const w=new Blob([x.textContent],{type:"text/html"}),e=URL.createObjectURL(w),r=document.createElement("a");r.href=e,r.download="output.html",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(e)}else alert("No output to download.")});async function Ie(w){const e=new j(w,"input.docx",{readonly:!0}),r=new j(new Uint8Array,"output.html",{readonly:!1}),o=[new fe(new j(new Uint8Array,{readonly:!0})),P.lineBuffered(p=>x.textContent+=`[stdout] ${p}
`),P.lineBuffered(p=>x.textContent+=`[stderr] ${p}
`),new Ue("/",[["in",e],["out",r]])],l=["pandoc.wasm","+RTS","-H64m","-RTS"],t=new xe(l,[],o,{debug:!1}),{instance:n}=await WebAssembly.instantiateStreaming(fetch("https://tweag.github.io/pandoc-wasm/pandoc.wasm"),{wasi_snapshot_preview1:t.wasiImport});t.initialize(n),n.exports.__wasm_call_ctors(),new TextEncoder;const s="-f docx -t html";function i(){return new DataView(n.exports.memory.buffer)}const f=n.exports.malloc(4);i().setUint32(f,l.length,!0);const a=n.exports.malloc(4*(l.length+1));for(let p=0;p<l.length;++p){const b=n.exports.malloc(l[p].length+1);new TextEncoder().encodeInto(l[p],new Uint8Array(n.exports.memory.buffer,b,l[p].length)),i().setUint8(b+l[p].length,0),i().setUint32(a+4*p,b,!0)}i().setUint32(a+4*l.length,0,!0);const u=n.exports.malloc(4);i().setUint32(u,a,!0),n.exports.hs_init_with_rtsopts(f,u);const d=new TextEncoder().encode(s),h=n.exports.malloc(d.length+1),y=new Uint8Array(n.exports.memory.buffer,h,d.length+1);y.set(d),y[d.length]=0,n.exports.wasm_main(h,d.length);const _=r.data;return new TextDecoder().decode(_)}z.addEventListener("submit",async w=>{var o;w.preventDefault(),x.textContent="";const e=(o=N.files)==null?void 0:o[0];if(!e)return;const r=new Uint8Array(await e.arrayBuffer());try{const l=await Ie(r);x.classList.remove("hidden"),F.classList.remove("hidden"),F.classList.add("flex"),z.classList.add("hidden"),z.classList.remove("flex"),le.classList.add("hidden"),x.textContent+=`
--- OUTPUT FILE ---
`+l}catch(l){x.textContent=`Error: ${l.message}`,x.classList.remove("hidden")}});
