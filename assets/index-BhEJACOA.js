(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const t of l)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&o(r)}).observe(document,{childList:!0,subtree:!0});function n(l){const t={};return l.integrity&&(t.integrity=l.integrity),l.referrerPolicy&&(t.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?t.credentials="include":l.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(l){if(l.ep)return;l.ep=!0;const t=n(l);fetch(l.href,t)}})();const K=0,X=1,g=0,_=8,z=20,P=28,$=31,oe=37,I=44,ae=52,D=54,q=55,m=58,M=63,J=76,W=64;class O{static read_bytes(e,n){const o=new O;return o.buf=e.getUint32(n,!0),o.buf_len=e.getUint32(n+4,!0),o}static read_bytes_array(e,n,o){const l=[];for(let t=0;t<o;t++)l.push(O.read_bytes(e,n+8*t));return l}}class L{static read_bytes(e,n){const o=new L;return o.buf=e.getUint32(n,!0),o.buf_len=e.getUint32(n+4,!0),o}static read_bytes_array(e,n,o){const l=[];for(let t=0;t<o;t++)l.push(L.read_bytes(e,n+8*t));return l}}const le=0,ue=1,re=2,Q=2,A=3,V=4;class C{head_length(){return 24}name_length(){return this.dir_name.byteLength}write_head_bytes(e,n){e.setBigUint64(n,this.d_next,!0),e.setBigUint64(n+8,this.d_ino,!0),e.setUint32(n+16,this.dir_name.length,!0),e.setUint8(n+20,this.d_type)}write_name_bytes(e,n,o){e.set(this.dir_name.slice(0,Math.min(this.dir_name.byteLength,o)),n)}constructor(e,n,o,l){const t=new TextEncoder().encode(o);this.d_next=e,this.d_ino=n,this.d_namlen=t.byteLength,this.d_type=l,this.dir_name=t}}const de=1;class v{write_bytes(e,n){e.setUint8(n,this.fs_filetype),e.setUint16(n+2,this.fs_flags,!0),e.setBigUint64(n+8,this.fs_rights_base,!0),e.setBigUint64(n+16,this.fs_rights_inherited,!0)}constructor(e,n){this.fs_rights_base=0n,this.fs_rights_inherited=0n,this.fs_filetype=e,this.fs_flags=n}}const F=1,R=2,Z=4,ee=8;class G{write_bytes(e,n){e.setBigUint64(n,this.dev,!0),e.setBigUint64(n+8,this.ino,!0),e.setUint8(n+16,this.filetype),e.setBigUint64(n+24,this.nlink,!0),e.setBigUint64(n+32,this.size,!0),e.setBigUint64(n+38,this.atim,!0),e.setBigUint64(n+46,this.mtim,!0),e.setBigUint64(n+52,this.ctim,!0)}constructor(e,n,o){this.dev=0n,this.nlink=0n,this.atim=0n,this.mtim=0n,this.ctim=0n,this.ino=e,this.filetype=n,this.size=o}}const ce=0;class _e{write_bytes(e,n){e.setUint32(n,this.pr_name.byteLength,!0)}constructor(e){this.pr_name=new TextEncoder().encode(e)}}class Y{static dir(e){const n=new Y;return n.tag=ce,n.inner=new _e(e),n}write_bytes(e,n){e.setUint32(n,this.tag,!0),this.inner.write_bytes(e,n+4)}}let he=class{enable(e){this.log=pe(e===void 0?!0:e,this.prefix)}get enabled(){return this.isEnabled}constructor(e){this.isEnabled=e,this.prefix="wasi:",this.enable(e)}};function pe(x,e){return x?console.log.bind(console,"%c%s","color: #265BA0",e):()=>{}}const U=new he(!1);class te extends Error{constructor(e){super("exit with exit code "+e),this.code=e}}let ye=class{start(e){this.inst=e;try{return e.exports._start(),0}catch(n){if(n instanceof te)return n.code;throw n}}initialize(e){this.inst=e,e.exports._initialize&&e.exports._initialize()}constructor(e,n,o,l={}){this.args=[],this.env=[],this.fds=[],U.enable(l.debug),this.args=e,this.env=n,this.fds=o;const t=this;this.wasiImport={args_sizes_get(r,s){const i=new DataView(t.inst.exports.memory.buffer);i.setUint32(r,t.args.length,!0);let f=0;for(const a of t.args)f+=a.length+1;return i.setUint32(s,f,!0),U.log(i.getUint32(r,!0),i.getUint32(s,!0)),0},args_get(r,s){const i=new DataView(t.inst.exports.memory.buffer),f=new Uint8Array(t.inst.exports.memory.buffer),a=s;for(let u=0;u<t.args.length;u++){i.setUint32(r,s,!0),r+=4;const d=new TextEncoder().encode(t.args[u]);f.set(d,s),i.setUint8(s+d.length,0),s+=d.length+1}return U.enabled&&U.log(new TextDecoder("utf-8").decode(f.slice(a,s))),0},environ_sizes_get(r,s){const i=new DataView(t.inst.exports.memory.buffer);i.setUint32(r,t.env.length,!0);let f=0;for(const a of t.env)f+=a.length+1;return i.setUint32(s,f,!0),U.log(i.getUint32(r,!0),i.getUint32(s,!0)),0},environ_get(r,s){const i=new DataView(t.inst.exports.memory.buffer),f=new Uint8Array(t.inst.exports.memory.buffer),a=s;for(let u=0;u<t.env.length;u++){i.setUint32(r,s,!0),r+=4;const d=new TextEncoder().encode(t.env[u]);f.set(d,s),i.setUint8(s+d.length,0),s+=d.length+1}return U.enabled&&U.log(new TextDecoder("utf-8").decode(f.slice(a,s))),0},clock_res_get(r,s){let i;switch(r){case X:{i=5000n;break}case K:{i=1000000n;break}default:return ae}return new DataView(t.inst.exports.memory.buffer).setBigUint64(s,i,!0),g},clock_time_get(r,s,i){const f=new DataView(t.inst.exports.memory.buffer);if(r===K)f.setBigUint64(i,BigInt(new Date().getTime())*1000000n,!0);else if(r==X){let a;try{a=BigInt(Math.round(performance.now()*1e6))}catch{a=0n}f.setBigUint64(i,a,!0)}else f.setBigUint64(i,0n,!0);return 0},fd_advise(r,s,i,f){return t.fds[r]!=null?g:_},fd_allocate(r,s,i){return t.fds[r]!=null?t.fds[r].fd_allocate(s,i):_},fd_close(r){if(t.fds[r]!=null){const s=t.fds[r].fd_close();return t.fds[r]=void 0,s}else return _},fd_datasync(r){return t.fds[r]!=null?t.fds[r].fd_sync():_},fd_fdstat_get(r,s){if(t.fds[r]!=null){const{ret:i,fdstat:f}=t.fds[r].fd_fdstat_get();return f!=null&&f.write_bytes(new DataView(t.inst.exports.memory.buffer),s),i}else return _},fd_fdstat_set_flags(r,s){return t.fds[r]!=null?t.fds[r].fd_fdstat_set_flags(s):_},fd_fdstat_set_rights(r,s,i){return t.fds[r]!=null?t.fds[r].fd_fdstat_set_rights(s,i):_},fd_filestat_get(r,s){if(t.fds[r]!=null){const{ret:i,filestat:f}=t.fds[r].fd_filestat_get();return f!=null&&f.write_bytes(new DataView(t.inst.exports.memory.buffer),s),i}else return _},fd_filestat_set_size(r,s){return t.fds[r]!=null?t.fds[r].fd_filestat_set_size(s):_},fd_filestat_set_times(r,s,i,f){return t.fds[r]!=null?t.fds[r].fd_filestat_set_times(s,i,f):_},fd_pread(r,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const h=O.read_bytes_array(u,s,i);let p=0;for(const c of h){const{ret:y,data:w}=t.fds[r].fd_pread(c.buf_len,f);if(y!=g)return u.setUint32(a,p,!0),y;if(d.set(w,c.buf),p+=w.length,f+=BigInt(w.length),w.length!=c.buf_len)break}return u.setUint32(a,p,!0),g}else return _},fd_prestat_get(r,s){const i=new DataView(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const{ret:f,prestat:a}=t.fds[r].fd_prestat_get();return a!=null&&a.write_bytes(i,s),f}else return _},fd_prestat_dir_name(r,s,i){if(t.fds[r]!=null){const{ret:f,prestat:a}=t.fds[r].fd_prestat_get();if(a==null)return f;const u=a.inner.pr_name;return new Uint8Array(t.inst.exports.memory.buffer).set(u.slice(0,i),s),u.byteLength>i?oe:g}else return _},fd_pwrite(r,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const h=L.read_bytes_array(u,s,i);let p=0;for(const c of h){const y=d.slice(c.buf,c.buf+c.buf_len),{ret:w,nwritten:b}=t.fds[r].fd_pwrite(y,f);if(w!=g)return u.setUint32(a,p,!0),w;if(p+=b,f+=BigInt(b),b!=y.byteLength)break}return u.setUint32(a,p,!0),g}else return _},fd_read(r,s,i,f){const a=new DataView(t.inst.exports.memory.buffer),u=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const d=O.read_bytes_array(a,s,i);let h=0;for(const p of d){const{ret:c,data:y}=t.fds[r].fd_read(p.buf_len);if(c!=g)return a.setUint32(f,h,!0),c;if(u.set(y,p.buf),h+=y.length,y.length!=p.buf_len)break}return a.setUint32(f,h,!0),g}else return _},fd_readdir(r,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){let h=0;for(;;){const{ret:p,dirent:c}=t.fds[r].fd_readdir_single(f);if(p!=0)return u.setUint32(a,h,!0),p;if(c==null)break;if(i-h<c.head_length()){h=i;break}const y=new ArrayBuffer(c.head_length());if(c.write_head_bytes(new DataView(y),0),d.set(new Uint8Array(y).slice(0,Math.min(y.byteLength,i-h)),s),s+=c.head_length(),h+=c.head_length(),i-h<c.name_length()){h=i;break}c.write_name_bytes(d,s,i-h),s+=c.name_length(),h+=c.name_length(),f=c.d_next}return u.setUint32(a,h,!0),0}else return _},fd_renumber(r,s){if(t.fds[r]!=null&&t.fds[s]!=null){const i=t.fds[s].fd_close();return i!=0?i:(t.fds[s]=t.fds[r],t.fds[r]=void 0,0)}else return _},fd_seek(r,s,i,f){const a=new DataView(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const{ret:u,offset:d}=t.fds[r].fd_seek(s,i);return a.setBigInt64(f,d,!0),u}else return _},fd_sync(r){return t.fds[r]!=null?t.fds[r].fd_sync():_},fd_tell(r,s){const i=new DataView(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const{ret:f,offset:a}=t.fds[r].fd_tell();return i.setBigUint64(s,a,!0),f}else return _},fd_write(r,s,i,f){const a=new DataView(t.inst.exports.memory.buffer),u=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const d=L.read_bytes_array(a,s,i);let h=0;for(const p of d){const c=u.slice(p.buf,p.buf+p.buf_len),{ret:y,nwritten:w}=t.fds[r].fd_write(c);if(y!=g)return a.setUint32(f,h,!0),y;if(h+=w,w!=c.byteLength)break}return a.setUint32(f,h,!0),g}else return _},path_create_directory(r,s,i){const f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const a=new TextDecoder("utf-8").decode(f.slice(s,s+i));return t.fds[r].path_create_directory(a)}else return _},path_filestat_get(r,s,i,f,a){const u=new DataView(t.inst.exports.memory.buffer),d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const h=new TextDecoder("utf-8").decode(d.slice(i,i+f)),{ret:p,filestat:c}=t.fds[r].path_filestat_get(s,h);return c!=null&&c.write_bytes(u,a),p}else return _},path_filestat_set_times(r,s,i,f,a,u,d){const h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const p=new TextDecoder("utf-8").decode(h.slice(i,i+f));return t.fds[r].path_filestat_set_times(s,p,a,u,d)}else return _},path_link(r,s,i,f,a,u,d){const h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null&&t.fds[a]!=null){const p=new TextDecoder("utf-8").decode(h.slice(i,i+f)),c=new TextDecoder("utf-8").decode(h.slice(u,u+d)),{ret:y,inode_obj:w}=t.fds[r].path_lookup(p,s);return w==null?y:t.fds[a].path_link(c,w,!1)}else return _},path_open(r,s,i,f,a,u,d,h,p){const c=new DataView(t.inst.exports.memory.buffer),y=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const w=new TextDecoder("utf-8").decode(y.slice(i,i+f));U.log(w);const{ret:b,fd_obj:N}=t.fds[r].path_open(s,w,a,u,d,h);if(b!=0)return b;t.fds.push(N);const fe=t.fds.length-1;return c.setUint32(p,fe,!0),0}else return _},path_readlink(r,s,i,f,a,u){const d=new DataView(t.inst.exports.memory.buffer),h=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const p=new TextDecoder("utf-8").decode(h.slice(s,s+i));U.log(p);const{ret:c,data:y}=t.fds[r].path_readlink(p);if(y!=null){const w=new TextEncoder().encode(y);if(w.length>a)return d.setUint32(u,0,!0),_;h.set(w,f),d.setUint32(u,w.length,!0)}return c}else return _},path_remove_directory(r,s,i){const f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const a=new TextDecoder("utf-8").decode(f.slice(s,s+i));return t.fds[r].path_remove_directory(a)}else return _},path_rename(r,s,i,f,a,u){const d=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null&&t.fds[f]!=null){const h=new TextDecoder("utf-8").decode(d.slice(s,s+i)),p=new TextDecoder("utf-8").decode(d.slice(a,a+u));let{ret:c,inode_obj:y}=t.fds[r].path_unlink(h);if(y==null)return c;if(c=t.fds[f].path_link(p,y,!0),c!=g&&t.fds[r].path_link(h,y,!0)!=g)throw"path_link should always return success when relinking an inode back to the original place";return c}else return _},path_symlink(r,s,i,f,a){const u=new Uint8Array(t.inst.exports.memory.buffer);return t.fds[i]!=null?(new TextDecoder("utf-8").decode(u.slice(r,r+s)),new TextDecoder("utf-8").decode(u.slice(f,f+a)),m):_},path_unlink_file(r,s,i){const f=new Uint8Array(t.inst.exports.memory.buffer);if(t.fds[r]!=null){const a=new TextDecoder("utf-8").decode(f.slice(s,s+i));return t.fds[r].path_unlink_file(a)}else return _},poll_oneoff(r,s,i){throw"async io not supported"},proc_exit(r){throw new te(r)},proc_raise(r){throw"raised signal "+r},sched_yield(){},random_get(r,s){const i=new Uint8Array(t.inst.exports.memory.buffer).subarray(r,r+s);if("crypto"in globalThis&&(typeof SharedArrayBuffer>"u"||!(t.inst.exports.memory.buffer instanceof SharedArrayBuffer)))for(let f=0;f<s;f+=65536)crypto.getRandomValues(i.subarray(f,f+65536));else for(let f=0;f<s;f++)i[f]=Math.random()*256|0},sock_recv(r,s,i){throw"sockets not supported"},sock_send(r,s,i){throw"sockets not supported"},sock_shutdown(r,s){throw"sockets not supported"},sock_accept(r,s){throw"sockets not supported"}}}};class H{fd_allocate(e,n){return m}fd_close(){return 0}fd_fdstat_get(){return{ret:m,fdstat:null}}fd_fdstat_set_flags(e){return m}fd_fdstat_set_rights(e,n){return m}fd_filestat_get(){return{ret:m,filestat:null}}fd_filestat_set_size(e){return m}fd_filestat_set_times(e,n,o){return m}fd_pread(e,n){return{ret:m,data:new Uint8Array}}fd_prestat_get(){return{ret:m,prestat:null}}fd_pwrite(e,n){return{ret:m,nwritten:0}}fd_read(e){return{ret:m,data:new Uint8Array}}fd_readdir_single(e){return{ret:m,dirent:null}}fd_seek(e,n){return{ret:m,offset:0n}}fd_sync(){return 0}fd_tell(){return{ret:m,offset:0n}}fd_write(e){return{ret:m,nwritten:0}}path_create_directory(e){return m}path_filestat_get(e,n){return{ret:m,filestat:null}}path_filestat_set_times(e,n,o,l,t){return m}path_link(e,n,o){return m}path_unlink(e){return{ret:m,inode_obj:null}}path_lookup(e,n){return{ret:m,inode_obj:null}}path_open(e,n,o,l,t,r){return{ret:D,fd_obj:null}}path_readlink(e){return{ret:m,data:null}}path_remove_directory(e){return m}path_rename(e,n,o){return m}path_unlink_file(e){return m}}class B{static issue_ino(){return B.next_ino++}static root_ino(){return 0n}constructor(){this.ino=B.issue_ino()}}B.next_ino=1n;class ne extends H{fd_allocate(e,n){if(!(this.file.size>e+n)){const o=new Uint8Array(Number(e+n));o.set(this.file.data,0),this.file.data=o}return g}fd_fdstat_get(){return{ret:0,fdstat:new v(V,0)}}fd_filestat_set_size(e){if(this.file.size>e)this.file.data=new Uint8Array(this.file.data.buffer.slice(0,Number(e)));else{const n=new Uint8Array(Number(e));n.set(this.file.data,0),this.file.data=n}return g}fd_read(e){const n=this.file.data.slice(Number(this.file_pos),Number(this.file_pos+BigInt(e)));return this.file_pos+=BigInt(n.length),{ret:0,data:n}}fd_pread(e,n){return{ret:0,data:this.file.data.slice(Number(n),Number(n+BigInt(e)))}}fd_seek(e,n){let o;switch(n){case le:o=e;break;case ue:o=this.file_pos+e;break;case re:o=BigInt(this.file.data.byteLength)+e;break;default:return{ret:P,offset:0n}}return o<0?{ret:P,offset:0n}:(this.file_pos=o,{ret:0,offset:this.file_pos})}fd_tell(){return{ret:0,offset:this.file_pos}}fd_write(e){if(this.file.readonly)return{ret:_,nwritten:0};if(this.file_pos+BigInt(e.byteLength)>this.file.size){const n=this.file.data;this.file.data=new Uint8Array(Number(this.file_pos+BigInt(e.byteLength))),this.file.data.set(n)}return this.file.data.set(e,Number(this.file_pos)),this.file_pos+=BigInt(e.byteLength),{ret:0,nwritten:e.byteLength}}fd_pwrite(e,n){if(this.file.readonly)return{ret:_,nwritten:0};if(n+BigInt(e.byteLength)>this.file.size){const o=this.file.data;this.file.data=new Uint8Array(Number(n+BigInt(e.byteLength))),this.file.data.set(o)}return this.file.data.set(e,Number(n)),{ret:0,nwritten:e.byteLength}}fd_filestat_get(){return{ret:0,filestat:this.file.stat()}}constructor(e){super(),this.file_pos=0n,this.file=e}}class se extends H{fd_seek(e,n){return{ret:_,offset:0n}}fd_tell(){return{ret:_,offset:0n}}fd_allocate(e,n){return _}fd_fdstat_get(){return{ret:0,fdstat:new v(A,0)}}fd_readdir_single(e){if(U.enabled&&(U.log("readdir_single",e),U.log(e,this.dir.contents.keys())),e==0n)return{ret:g,dirent:new C(1n,this.dir.ino,".",A)};if(e==1n)return{ret:g,dirent:new C(2n,this.dir.parent_ino(),"..",A)};if(e>=BigInt(this.dir.contents.size)+2n)return{ret:0,dirent:null};const[n,o]=Array.from(this.dir.contents.entries())[Number(e-2n)];return{ret:0,dirent:new C(e+1n,o.ino,n,o.stat().filetype)}}path_filestat_get(e,n){const{ret:o,path:l}=E.from(n);if(l==null)return{ret:o,filestat:null};const{ret:t,entry:r}=this.dir.get_entry_for_path(l);return r==null?{ret:t,filestat:null}:{ret:0,filestat:r.stat()}}path_lookup(e,n){const{ret:o,path:l}=E.from(e);if(l==null)return{ret:o,inode_obj:null};const{ret:t,entry:r}=this.dir.get_entry_for_path(l);return r==null?{ret:t,inode_obj:null}:{ret:g,inode_obj:r}}path_open(e,n,o,l,t,r){const{ret:s,path:i}=E.from(n);if(i==null)return{ret:s,fd_obj:null};let{ret:f,entry:a}=this.dir.get_entry_for_path(i);if(a==null){if(f!=I)return{ret:f,fd_obj:null};if((o&F)==F){const{ret:u,entry:d}=this.dir.create_entry_for_path(n,(o&R)==R);if(d==null)return{ret:u,fd_obj:null};a=d}else return{ret:I,fd_obj:null}}else if((o&Z)==Z)return{ret:z,fd_obj:null};return(o&R)==R&&a.stat().filetype!==A?{ret:D,fd_obj:null}:a.path_open(o,l,r)}path_create_directory(e){return this.path_open(0,e,F|R,0n,0n,0).ret}path_link(e,n,o){const{ret:l,path:t}=E.from(e);if(t==null)return l;if(t.is_dir)return I;const{ret:r,parent_entry:s,filename:i,entry:f}=this.dir.get_parent_dir_and_entry_for_path(t,!0);if(s==null||i==null)return r;if(f!=null){const a=n.stat().filetype==A,u=f.stat().filetype==A;if(a&&u)if(o&&f instanceof T){if(f.contents.size!=0)return q}else return z;else{if(a&&!u)return D;if(!a&&u)return $;if(!(n.stat().filetype==V&&f.stat().filetype==V))return z}}return!o&&n.stat().filetype==A?M:(s.contents.set(i,n),g)}path_unlink(e){const{ret:n,path:o}=E.from(e);if(o==null)return{ret:n,inode_obj:null};const{ret:l,parent_entry:t,filename:r,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!0);return t==null||r==null?{ret:l,inode_obj:null}:s==null?{ret:I,inode_obj:null}:(t.contents.delete(r),{ret:g,inode_obj:s})}path_unlink_file(e){const{ret:n,path:o}=E.from(e);if(o==null)return n;const{ret:l,parent_entry:t,filename:r,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!1);return t==null||r==null||s==null?l:s.stat().filetype===A?$:(t.contents.delete(r),g)}path_remove_directory(e){const{ret:n,path:o}=E.from(e);if(o==null)return n;const{ret:l,parent_entry:t,filename:r,entry:s}=this.dir.get_parent_dir_and_entry_for_path(o,!1);return t==null||r==null||s==null?l:!(s instanceof T)||s.stat().filetype!==A?D:s.contents.size!==0?q:t.contents.delete(r)?g:I}fd_filestat_get(){return{ret:0,filestat:this.dir.stat()}}fd_filestat_set_size(e){return _}fd_read(e){return{ret:_,data:new Uint8Array}}fd_pread(e,n){return{ret:_,data:new Uint8Array}}fd_write(e){return{ret:_,nwritten:0}}fd_pwrite(e,n){return{ret:_,nwritten:0}}constructor(e){super(),this.dir=e}}class ge extends se{fd_prestat_get(){return{ret:0,prestat:Y.dir(this.prestat_name)}}constructor(e,n){super(new T(n)),this.prestat_name=e}}class S extends B{path_open(e,n,o){if(this.readonly&&(n&BigInt(W))==BigInt(W))return{ret:M,fd_obj:null};if((e&ee)==ee){if(this.readonly)return{ret:M,fd_obj:null};this.data=new Uint8Array([])}const l=new ne(this);return o&de&&l.fd_seek(0n,re),{ret:g,fd_obj:l}}get size(){return BigInt(this.data.byteLength)}stat(){return new G(this.ino,V,this.size)}constructor(e,n){super(),this.data=new Uint8Array(e),this.readonly=!!(n!=null&&n.readonly)}}let E=class ie{static from(e){const n=new ie;if(n.is_dir=e.endsWith("/"),e.startsWith("/"))return{ret:J,path:null};if(e.includes("\0"))return{ret:P,path:null};for(const o of e.split("/"))if(!(o===""||o===".")){if(o===".."){if(n.parts.pop()==null)return{ret:J,path:null};continue}n.parts.push(o)}return{ret:g,path:n}}to_path_string(){let e=this.parts.join("/");return this.is_dir&&(e+="/"),e}constructor(){this.parts=[],this.is_dir=!1}};class T extends B{parent_ino(){return this.parent==null?B.root_ino():this.parent.ino}path_open(e,n,o){return{ret:g,fd_obj:new se(this)}}stat(){return new G(this.ino,A,0n)}get_entry_for_path(e){let n=this;for(const o of e.parts){if(!(n instanceof T))return{ret:D,entry:null};const l=n.contents.get(o);if(l!==void 0)n=l;else return U.log(o),{ret:I,entry:null}}return e.is_dir&&n.stat().filetype!=A?{ret:D,entry:null}:{ret:g,entry:n}}get_parent_dir_and_entry_for_path(e,n){const o=e.parts.pop();if(o===void 0)return{ret:P,parent_entry:null,filename:null,entry:null};const{ret:l,entry:t}=this.get_entry_for_path(e);if(t==null)return{ret:l,parent_entry:null,filename:null,entry:null};if(!(t instanceof T))return{ret:D,parent_entry:null,filename:null,entry:null};const r=t.contents.get(o);return r===void 0?n?{ret:g,parent_entry:t,filename:o,entry:null}:{ret:I,parent_entry:null,filename:null,entry:null}:e.is_dir&&r.stat().filetype!=A?{ret:D,parent_entry:null,filename:null,entry:null}:{ret:g,parent_entry:t,filename:o,entry:r}}create_entry_for_path(e,n){const{ret:o,path:l}=E.from(e);if(l==null)return{ret:o,entry:null};let{ret:t,parent_entry:r,filename:s,entry:i}=this.get_parent_dir_and_entry_for_path(l,!0);if(r==null||s==null)return{ret:t,entry:null};if(i!=null)return{ret:z,entry:null};U.log("create",l);let f;return n?f=new T(new Map):f=new S(new ArrayBuffer(0)),r.contents.set(s,f),i=f,{ret:g,entry:i}}constructor(e){super(),this.parent=null,e instanceof Array?this.contents=new Map(e):this.contents=e;for(const n of this.contents.values())n instanceof T&&(n.parent=this)}}class j extends H{fd_filestat_get(){return{ret:0,filestat:new G(this.ino,Q,BigInt(0))}}fd_fdstat_get(){const e=new v(Q,0);return e.fs_rights_base=BigInt(W),{ret:0,fdstat:e}}fd_write(e){return this.write(e),{ret:0,nwritten:e.byteLength}}static lineBuffered(e){const n=new TextDecoder("utf-8",{fatal:!1});let o="";return new j(l=>{o+=n.decode(l,{stream:!0});const t=o.split(`
`);for(const[r,s]of t.entries())r<t.length-1?e(s):o=s})}constructor(e){super(),this.ino=B.issue_ino(),this.write=e}}const k=document.getElementById("output"),me=document.getElementById("upload");me.addEventListener("change",async x=>{const e=x.target.files[0];if(!e)return;const n=new Uint8Array(await e.arrayBuffer()),o=new S(n,"input.docx",{readonly:!0}),l=new S(new Uint8Array,"output.html",{readonly:!1}),t=[new ne(new S(new Uint8Array,{readonly:!0})),j.lineBuffered(b=>k.textContent+=`[stdout] ${b}
`),j.lineBuffered(b=>k.textContent+=`[stderr] ${b}
`),new ge("/",[["in",o],["out",l]])],r=["pandoc.wasm","+RTS","-H64m","-RTS"],s=new ye(r,[],t,{debug:!1}),{instance:i}=await WebAssembly.instantiateStreaming(fetch("./pandoc.wasm"),{wasi_snapshot_preview1:s.wasiImport});s.initialize(i),i.exports.__wasm_call_ctors(),new TextEncoder;const f="-f docx -t html";function a(){return new DataView(i.exports.memory.buffer)}const u=i.exports.malloc(4);a().setUint32(u,r.length,!0);const d=i.exports.malloc(4*(r.length+1));for(let b=0;b<r.length;++b){const N=i.exports.malloc(r[b].length+1);new TextEncoder().encodeInto(r[b],new Uint8Array(i.exports.memory.buffer,N,r[b].length)),a().setUint8(N+r[b].length,0),a().setUint32(d+4*b,N,!0)}a().setUint32(d+4*r.length,0,!0);const h=i.exports.malloc(4);a().setUint32(h,d,!0),i.exports.hs_init_with_rtsopts(u,h);const p=new TextEncoder().encode(f),c=i.exports.malloc(p.length+1),y=new Uint8Array(i.exports.memory.buffer,c,p.length+1);y.set(p),y[p.length]=0,i.exports.wasm_main(c,p.length);const w=l.data;if(w&&w.length>0){const b=new TextDecoder("utf-8").decode(w);k.textContent+=`
--- OUTPUT FILE ---
`+b}else k.textContent+=`
--- NO OUTPUT FILE DATA ---
`});
